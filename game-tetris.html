<!DOCTYPE html>
<html lang="az">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetris - Baki-Sumqayit.site</title>
    <meta name="description" content="Əfsanəvi Tetris oyunu. Blokları yerləşdir, xalları topla.">
    <link rel="stylesheet" href="game-style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
    <header class="sticky-header">
        <a href="index.html" class="back-btn"><i class="fas fa-arrow-left"></i><span>Ana Səhifə</span></a>
        <div class="site-logo">baki-sumqayit.site</div>
    </header>
    <div class="main-container">
        <main class="game-wrapper" id="game-container">
            <style>
                .tetris-wrapper {
                    background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
                    color: #fff;
                    font-family: 'Poppins', sans-serif;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    border-radius: 20px;
                    padding: 20px;
                    width: 100%;
                    box-sizing: border-box;
                }

                .game-container-tetris {
                    position: relative;
                    background: rgba(0, 0, 0, 0.8);
                    padding: 10px;
                    border-radius: 15px;
                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    max-width: 320px;
                    width: 100%;
                }

                .header-tetris {
                    display: flex;
                    justify-content: space-between;
                    width: 100%;
                    margin-bottom: 10px;
                    padding: 0 10px;
                    box-sizing: border-box;
                }

                .score-box-tetris {
                    text-align: center;
                }

                .score-label-tetris {
                    font-size: 12px;
                    opacity: 0.7;
                    text-transform: uppercase;
                }

                .score-val-tetris {
                    font-size: 20px;
                    font-weight: bold;
                    color: #fdbb2d;
                }

                #tetris {
                    border: 2px solid #333;
                    background-color: #111;
                    display: block;
                    border-radius: 4px;
                    max-width: 100%;
                    height: auto;
                }

                /* Mobil Kontroller */
                .controls-tetris {
                    margin-top: 15px;
                    display: grid;
                    grid-template-columns: 1fr 1fr 1fr;
                    grid-template-rows: 1fr 1fr;
                    gap: 10px;
                    width: 100%;
                    max-width: 260px;
                }

                .btn-tetra {
                    background: rgba(255, 255, 255, 0.15);
                    border: none;
                    border-radius: 12px;
                    height: 50px;
                    color: white;
                    font-size: 24px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    transition: background 0.1s;
                    box-shadow: 0 4px 0 rgba(0, 0, 0, 0.2);
                }

                .btn-tetra:active {
                    background: rgba(255, 255, 255, 0.3);
                    transform: translateY(2px);
                    box-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);
                }

                .btn-rotate {
                    grid-column: 2;
                    background: #8e44ad;
                }

                .btn-left {
                    grid-row: 2;
                    grid-column: 1;
                }

                .btn-down {
                    grid-row: 2;
                    grid-column: 2;
                }

                .btn-right {
                    grid-row: 2;
                    grid-column: 3;
                }

                /* Game Over Modal */
                .modal-tetris {
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.85);
                    display: none;
                    flex-direction: column;
                    justify-content: center;
                    align-items: center;
                    z-index: 10;
                    border-radius: 15px;
                }

                .modal-tetris h2 {
                    font-size: 30px;
                    margin-bottom: 10px;
                    color: #e74c3c;
                }

                .btn-restart-tetris {
                    background: #27ae60;
                    color: white;
                    border: none;
                    padding: 10px 25px;
                    font-size: 18px;
                    border-radius: 25px;
                    cursor: pointer;
                    margin-top: 15px;
                }

                /* PC için kontrolleri gizle/göster */
                @media (min-width: 768px) {
                    .controls-tetris {
                        display: none;
                    }

                    /* PC'de butonları gizle */
                }
            </style>

            <div class="tetris-wrapper">
                <div class="game-container-tetris">
                    <div class="header-tetris">
                        <div class="score-box-tetris">
                            <div class="score-label-tetris">XAL</div>
                            <div class="score-val-tetris" id="score">0</div>
                        </div>
                        <div class="score-box-tetris">
                            <div class="score-label-tetris">REKORD</div>
                            <div class="score-val-tetris" id="highscore">0</div>
                        </div>
                    </div>

                    <canvas id="tetris" width="240" height="400"></canvas>

                    <!-- Mobil Kontroller -->
                    <div class="controls-tetris">
                        <button class="btn-tetra btn-rotate" id="rotateBtn">↻</button>
                        <button class="btn-tetra btn-left" id="leftBtn">←</button>
                        <button class="btn-tetra btn-down" id="downBtn">↓</button>
                        <button class="btn-tetra btn-right" id="rightBtn">→</button>
                    </div>

                    <div class="modal-tetris" id="gameOverModal">
                        <h2>Oyun Bitdi!</h2>
                        <p>Xalınız: <span id="finalScore">0</span></p>
                        <button class="btn-restart-tetris" onclick="resetGame()">Yenidən Oyna</button>
                    </div>
                </div>

                <div style="margin-top: 10px; font-size: 14px; opacity: 0.7;">
                    PC: Yön düymələri | Mobil: Düymələr
                </div>
            </div>

            <script>
                const canvas = document.getElementById('tetris');
                const context = canvas.getContext('2d');
                const scoreElement = document.getElementById('score');
                const highscoreElement = document.getElementById('highscore');
                const modal = document.getElementById('gameOverModal');
                const finalScoreElement = document.getElementById('finalScore');

                context.scale(20, 20); // Her kareyi 20px yap

                // Oyun durumu
                let dropCounter = 0;
                let dropInterval = 1000;
                let lastTime = 0;
                let score = 0;
                let highScore = localStorage.getItem('tetris_high') || 0;
                highscoreElement.innerText = highScore;

                // Oyun Alanı (12x20)
                const arena = createMatrix(12, 20);

                // Parçalar
                const player = {
                    pos: { x: 0, y: 0 },
                    matrix: null,
                    score: 0,
                };

                // Renkler
                const colors = [
                    null,
                    '#FF0D72', // T
                    '#0DC2FF', // O
                    '#0DFF72', // L
                    '#F538FF', // J
                    '#FF8E0D', // I
                    '#FFE138', // S
                    '#3877FF', // Z
                ];

                function createMatrix(w, h) {
                    const matrix = [];
                    while (h--) {
                        matrix.push(new Array(w).fill(0));
                    }
                    return matrix;
                }

                function createPiece(type) {
                    if (type === 'I') {
                        return [
                            [0, 1, 0, 0],
                            [0, 1, 0, 0],
                            [0, 1, 0, 0],
                            [0, 1, 0, 0],
                        ];
                    } else if (type === 'L') {
                        return [
                            [0, 2, 0],
                            [0, 2, 0],
                            [0, 2, 2],
                        ];
                    } else if (type === 'J') {
                        return [
                            [0, 3, 0],
                            [0, 3, 0],
                            [3, 3, 0],
                        ];
                    } else if (type === 'O') {
                        return [
                            [4, 4],
                            [4, 4],
                        ];
                    } else if (type === 'Z') {
                        return [
                            [5, 5, 0],
                            [0, 5, 5],
                            [0, 0, 0],
                        ];
                    } else if (type === 'S') {
                        return [
                            [0, 6, 6],
                            [6, 6, 0],
                            [0, 0, 0],
                        ];
                    } else if (type === 'T') {
                        return [
                            [0, 7, 0],
                            [7, 7, 7],
                            [0, 0, 0],
                        ];
                    }
                }

                function draw() {
                    context.fillStyle = '#111';
                    context.fillRect(0, 0, canvas.width, canvas.height);

                    drawMatrix(arena, { x: 0, y: 0 });
                    drawMatrix(player.matrix, player.pos);
                }

                function drawMatrix(matrix, offset) {
                    matrix.forEach((row, y) => {
                        row.forEach((value, x) => {
                            if (value !== 0) {
                                // Parça rengi
                                context.fillStyle = colors[value];
                                context.fillRect(x + offset.x, y + offset.y, 1, 1);

                                // Gölge/Efekt (3D hissi için)
                                context.lineWidth = 0.05;
                                context.strokeStyle = 'white';
                                context.strokeRect(x + offset.x, y + offset.y, 1, 1);
                            }
                        });
                    });
                }

                function merge(arena, player) {
                    player.matrix.forEach((row, y) => {
                        row.forEach((value, x) => {
                            if (value !== 0) {
                                arena[y + player.pos.y][x + player.pos.x] = value;
                            }
                        });
                    });
                }

                function rotate(matrix, dir) {
                    for (let y = 0; y < matrix.length; ++y) {
                        for (let x = 0; x < y; ++x) {
                            [
                                matrix[x][y],
                                matrix[y][x],
                            ] = [
                                    matrix[y][x],
                                    matrix[x][y],
                                ];
                        }
                    }
                    if (dir > 0) {
                        matrix.forEach(row => row.reverse());
                    } else {
                        matrix.reverse();
                    }
                }

                function playerDrop() {
                    player.pos.y++;
                    if (collide(arena, player)) {
                        player.pos.y--;
                        merge(arena, player);
                        playerReset();
                        arenaSweep();
                        updateScore();
                    }
                    dropCounter = 0;
                }

                function playerMove(offset) {
                    player.pos.x += offset;
                    if (collide(arena, player)) {
                        player.pos.x -= offset;
                    }
                }

                function playerRotate(dir) {
                    const pos = player.pos.x;
                    let offset = 1;
                    rotate(player.matrix, dir);
                    while (collide(arena, player)) {
                        player.pos.x += offset;
                        offset = -(offset + (offset > 0 ? 1 : -1));
                        if (offset > player.matrix[0].length) {
                            rotate(player.matrix, -dir);
                            player.pos.x = pos;
                            return;
                        }
                    }
                }

                function playerReset() {
                    const pieces = 'ILJOTSZ';
                    player.matrix = createPiece(pieces[pieces.length * Math.random() | 0]);
                    player.pos.y = 0;
                    player.pos.x = (arena[0].length / 2 | 0) - (player.matrix[0].length / 2 | 0);

                    // Oyun Bitti mi?
                    if (collide(arena, player)) {
                        gameOver();
                    }
                }

                function arenaSweep() {
                    let rowCount = 1;
                    outer: for (let y = arena.length - 1; y > 0; --y) {
                        for (let x = 0; x < arena[y].length; ++x) {
                            if (arena[y][x] === 0) {
                                continue outer;
                            }
                        }
                        const row = arena.splice(y, 1)[0].fill(0);
                        arena.unshift(row);
                        ++y;
                        player.score += rowCount * 10;
                        rowCount *= 2;
                    }
                }

                function collide(arena, player) {
                    const m = player.matrix;
                    const o = player.pos;
                    for (let y = 0; y < m.length; ++y) {
                        for (let x = 0; x < m[y].length; ++x) {
                            if (m[y][x] !== 0 &&
                                (arena[y + o.y] &&
                                    arena[y + o.y][x + o.x]) !== 0) {
                                return true;
                            }
                        }
                    }
                    return false;
                }

                function updateScore() {
                    scoreElement.innerText = player.score;
                }

                function gameOver() {
                    modal.style.display = 'flex';
                    finalScoreElement.innerText = player.score;
                    if (player.score > highScore) {
                        highScore = player.score;
                        localStorage.setItem('tetris_high', highScore);
                        highscoreElement.innerText = highScore;
                    }
                    // Oyunu durdurmak için matrix'i temizle veya loop'u durdur
                    // Burada basitçe matrix'i sıfırlıyoruz ama modal üstte olduğu için görünmez
                    player.matrix.forEach(row => row.fill(0));
                }

                function resetGame() {
                    arena.forEach(row => row.fill(0));
                    player.score = 0;
                    updateScore();
                    modal.style.display = 'none';
                    playerReset();
                }

                function update(time = 0) {
                    const deltaTime = time - lastTime;
                    lastTime = time;

                    dropCounter += deltaTime;
                    if (dropCounter > dropInterval) {
                        playerDrop();
                    }

                    draw();
                    requestAnimationFrame(update);
                }

                // Klavye Kontrolleri
                document.addEventListener('keydown', event => {
                    // Sadece oyun görünürse ve modal açık değilse
                    if (modal.style.display === 'flex') return;

                    // Ok tuşlarıyla kaydırmayı engellemek için preventDefault gerekebilir
                    // ancak burada basitlik için direk kodları kullanıyoruz.
                    // Eğer sayfa kayıyorsa preventDefault eklenmelidir.
                    if ([37, 38, 39, 40, 81].includes(event.keyCode)) {
                        event.preventDefault();
                    }

                    if (event.keyCode === 37) {
                        playerMove(-1);
                    } else if (event.keyCode === 39) {
                        playerMove(1);
                    } else if (event.keyCode === 40) {
                        playerDrop();
                    } else if (event.keyCode === 38 || event.keyCode === 81) {
                        playerRotate(1);
                    }
                });

                // Mobil Buton Kontrolleri
                // "Dokunma" (touchstart) olaylarını kullanıyoruz ki gecikme olmasın
                function addTouch(id, action) {
                    const btn = document.getElementById(id);
                    if (btn) {
                        btn.addEventListener('touchstart', (e) => {
                            e.preventDefault(); // Zoom'u engelle
                            action();
                        }, { passive: false });

                        // PC'de mouse ile tıklama için
                        btn.addEventListener('mousedown', (e) => {
                            action();
                        });
                    }
                }

                addTouch('leftBtn', () => playerMove(-1));
                addTouch('rightBtn', () => playerMove(1));
                addTouch('downBtn', () => playerDrop());
                addTouch('rotateBtn', () => playerRotate(1));

                playerReset();
                update();

            </script>
        </main>
        <!-- Other Games Panel -->
        <section class="max-w-4xl mx-auto mb-12 animate-fade-in" style="animation-delay: 200ms; padding: 0 20px;">
            <h2 class="text-2xl font-extrabold text-gray-800 mb-6 flex items-center">
                <i class="fa-solid fa-gamepad text-purple-600 mr-3"></i>
                Digər Oyunlar
            </h2>

            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4">
                <!-- 2048 -->
                <a href="game-2048.html"
                    class="glass-panel p-4 rounded-xl flex flex-col items-center justify-center group hover:bg-white transition-all border border-white/60 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-yellow-400/10 to-orange-500/10 opacity-0 group-hover:opacity-100 transition-opacity">
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-yellow-100 text-yellow-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform shadow-sm">
                        <i class="fa-solid fa-layer-group text-xl"></i>
                    </div>
                    <span class="font-bold text-gray-700 group-hover:text-yellow-700 text-sm">2048</span>
                </a>

                <!-- 15 Puzzle -->
                <a href="game-15puzzle.html"
                    class="glass-panel p-4 rounded-xl flex flex-col items-center justify-center group hover:bg-white transition-all border border-white/60 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-blue-400/10 to-indigo-500/10 opacity-0 group-hover:opacity-100 transition-opacity">
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform shadow-sm">
                        <i class="fa-solid fa-border-all text-xl"></i>
                    </div>
                    <span class="font-bold text-gray-700 group-hover:text-blue-700 text-sm">15 Puzzle</span>
                </a>

                <!-- Flappy -->
                <a href="game-flappy.html"
                    class="glass-panel p-4 rounded-xl flex flex-col items-center justify-center group hover:bg-white transition-all border border-white/60 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-sky-400/10 to-cyan-500/10 opacity-0 group-hover:opacity-100 transition-opacity">
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-sky-100 text-sky-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform shadow-sm">
                        <i class="fa-solid fa-dove text-xl"></i>
                    </div>
                    <span class="font-bold text-gray-700 group-hover:text-sky-700 text-sm">Uçan Top</span>
                </a>

                <!-- Snake -->
                <a href="game-snake.html"
                    class="glass-panel p-4 rounded-xl flex flex-col items-center justify-center group hover:bg-white transition-all border border-white/60 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-green-400/10 to-emerald-500/10 opacity-0 group-hover:opacity-100 transition-opacity">
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-green-100 text-green-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform shadow-sm">
                        <i class="fa-solid fa-staff-snake text-xl"></i>
                    </div>
                    <span class="font-bold text-gray-700 group-hover:text-green-700 text-sm">İlan</span>
                </a>

                <!-- TicTacToe -->
                <a href="game-tictactoe.html"
                    class="glass-panel p-4 rounded-xl flex flex-col items-center justify-center group hover:bg-white transition-all border border-white/60 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-red-400/10 to-pink-500/10 opacity-0 group-hover:opacity-100 transition-opacity">
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-red-100 text-red-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform shadow-sm">
                        <i class="fa-solid fa-xmarks-lines text-xl"></i>
                    </div>
                    <span class="font-bold text-gray-700 group-hover:text-red-700 text-sm">X-O</span>
                </a>

                <!-- Tetris -->
                <a href="game-tetris.html"
                    class="glass-panel p-4 rounded-xl flex flex-col items-center justify-center group hover:bg-white transition-all border border-white/60 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-indigo-400/10 to-purple-500/10 opacity-0 group-hover:opacity-100 transition-opacity">
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform shadow-sm">
                        <i class="fa-solid fa-shapes text-xl"></i>
                    </div>
                    <span class="font-bold text-gray-700 group-hover:text-indigo-700 text-sm">Tetris</span>
                </a>

                <!-- Memory -->
                <a href="game-memory.html"
                    class="glass-panel p-4 rounded-xl flex flex-col items-center justify-center group hover:bg-white transition-all border border-white/60 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-teal-400/10 to-green-500/10 opacity-0 group-hover:opacity-100 transition-opacity">
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-teal-100 text-teal-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform shadow-sm">
                        <i class="fa-solid fa-brain text-xl"></i>
                    </div>
                    <span class="font-bold text-gray-700 group-hover:text-teal-700 text-sm">Yaddaş</span>
                </a>

                <!-- Math -->
                <a href="game-math.html"
                    class="glass-panel p-4 rounded-xl flex flex-col items-center justify-center group hover:bg-white transition-all border border-white/60 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-orange-400/10 to-red-500/10 opacity-0 group-hover:opacity-100 transition-opacity">
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-orange-100 text-orange-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform shadow-sm">
                        <i class="fa-solid fa-calculator text-xl"></i>
                    </div>
                    <span class="font-bold text-gray-700 group-hover:text-orange-700 text-sm">Riyaziyyat</span>
                </a>

                <!-- Reflex (ZigZag) -->
                <a href="game-reflex.html"
                    class="glass-panel p-4 rounded-xl flex flex-col items-center justify-center group hover:bg-white transition-all border border-white/60 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-fuchsia-400/10 to-purple-500/10 opacity-0 group-hover:opacity-100 transition-opacity">
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-fuchsia-100 text-fuchsia-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform shadow-sm">
                        <i class="fa-solid fa-bolt text-xl"></i>
                    </div>
                    <span class="font-bold text-gray-700 group-hover:text-fuchsia-700 text-sm">Ziq Zaq</span>
                </a>

                <!-- Arkanoid -->
                <a href="game-arkanoid.html"
                    class="glass-panel p-4 rounded-xl flex flex-col items-center justify-center group hover:bg-white transition-all border border-white/60 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-rose-400/10 to-red-500/10 opacity-0 group-hover:opacity-100 transition-opacity">
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-rose-100 text-rose-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform shadow-sm">
                        <i class="fa-solid fa-cubes text-xl"></i>
                    </div>
                    <span class="font-bold text-gray-700 group-hover:text-rose-700 text-sm">Kərpic</span>
                </a>

            </div>
        </section>
        <article class="seo-content">
            <h1>Tetris - Blokları Yerləşdir, Xalları Qazan</h1>
            <h2>Necə Oynanılır?</h2>
            <p>Müxtəlif formalı bloklar yuxarıdan aşağı düşür. Blokları fırladaraq və hərəkət etdirərək aşağıda boşluq
                buraxmadan sıralar yaradın. Tamamlanan hər üfüqi sıra yox olur və sizə xal qazandırır.</p>
            <h3>Yüksək Xal Taktikaları:</h3>
            <ul>
                <li><strong>Düz Səth Yaradın:</strong> Səthi mümkün qədər düz saxlamağa çalışın.</li>
                <li><strong>"Tetris" Gözləyin:</strong> Uzun çubuğu (I forması) gözləyib eyni vaxtda 4 sıranı silmək
                    daha çox xal verir.</li>
                <li><strong>Gələcəyi Görün:</strong> Növbəti gələn fiqura baxaraq plan qurun.</li>
            </ul>
            <h2>Qatar Gözləyərkən Niyə Oynanmalı?</h2>
            <p>Tetris vizual zəkanı və sürətli qərar vermə qabiliyyətini inkişaf etdirir. O qədər axıcıdır ki, qatarın
                gəldiyini eşitməyə bilərsiniz!</p>
        </article>
    </div>
    <footer>
        <p>&copy; 2024 baki-sumqayit.site - Bütün hüquqlar qorunur.</p>
    </footer>
</body>

</html>